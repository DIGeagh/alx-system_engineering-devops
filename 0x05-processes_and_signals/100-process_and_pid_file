#!/usr/bin/env bash
# This script displays "To infinity and beyond" indefinitely
# and handles signals SIGTERM, SIGINT, SIGQUIT gracefully.

# Function to handle SIGTERM signal
function handle_sigterm() {
  echo "I hate the kill command"
}

# Function to handle SIGINT signal
function handle_sigint() {
  echo "Y U no love me?!"
}

# Function to handle SIGQUIT and SIGTERM signals
function handle_sigquit_sigterm() {
  echo "Deleting PID file and terminating..."
  rm -f /var/run/myscript.pid
  exit 0
}

# Trap the SIGTERM signal to call handle_sigterm function
trap handle_sigterm SIGTERM

# Trap the SIGINT signal to call handle_sigint function
trap handle_sigint SIGINT

# Trap the SIGQUIT and SIGTERM signals to call handle_sigquit_sigterm function
trap handle_sigquit_sigterm SIGQUIT SIGTERM

# Create the file /var/run/myscript.pid containing its PID
echo "$$" > /var/run/myscript.pid

# Display "To infinity and beyond" indefinitely
while true
do
  echo "To infinity and beyond"
  sleep 2
done
